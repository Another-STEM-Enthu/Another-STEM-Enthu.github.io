<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Varad's Blogs</title>
  <link rel="stylesheet" href="blogs.css">
</head>
<body>
<div class="slider-container">
  <label class="switch">
    <input type="checkbox" id="modeToggle">
    <span class="slider"></span>
  </label>
</div>
  <!-- Sitemap at top -->
  <div id="sitemap">
      <a href="index.html"><button class="btn"><span>Home</span></button></a>
      <a href="blogs.html"><button class="btn"><span>Posts</span></button></a>
      <!-- <a href="#about"><button class="btn"><span>About</span></button></a> -->
  </div>

  <header style="margin-top: var(--sitemap-height, 12vh);">
    <b>ðŸ“š Blogs</b>
  </header>

  <main class="container" style="margin-top: var(--sitemap-height, 8vh);">
    <aside id="blog-list" class="glass">
      <h1>All Posts</h1>
      <ul id="blogs"></ul>
    </aside>

    <section id="blog-content" class="glass">
      <div class="placeholder">
        <h2>Welcome!</h2>
        <p>Select a blog from the list to start reading.</p>
      </div>
    </section>
  </main>

<div style="text-align: right; color: white;"><br><br><br>Version 0.0<br>I am somewhat HTML literate.</div>
<div id="visitor-counter" style="
     position: fixed; 
     top: 1vh; 
     right: 2vw; 
     padding: 0.5em 1em; 
     background-color: rgba(0,0,0,0.1); 
     color: rgb(0,128,0); 
     font-weight: bold; 
     border: 2px solid rgb(0,128,0); 
     border-radius: 0.8vw;
     font-size: 1.2em;
     z-index: 1000;">
  Visitors: <span id="count">0</span>
</div>


<script src="blogs.js" defer></script>

<script>
const toggle = document.getElementById('modeToggle');
const blogList = document.getElementById("blog-list");
const blogContent = document.getElementById("blog-content");

window.addEventListener('DOMContentLoaded', () => {
  const state = localStorage.getItem('modeToggleState');
  if (state === 'true') {
    toggle.checked = true;
  } else {
    toggle.checked = false;
  }
document.body.classList.toggle('dark', toggle.checked);
blogList.style.backgroundColor= toggle.checked ? "rgba(0, 0, 0, 0.15)" : "rgba(255, 255, 255, 0.35)";
blogContent.style.backgroundColor= toggle.checked ? "rgba(0, 0, 0, 0.15)" : "rgba(255, 255, 255, 0.35)";
blogList.style.color= toggle.checked ? "rgba(255, 255, 255)" : "rgba(0, 0, 0)";
blogContent.style.color= toggle.checked ? "rgba(255, 255, 255)" : "rgba(0, 0, 0)";
});
toggle.addEventListener('change', () => {
localStorage.setItem('modeToggleState', toggle.checked);
document.body.classList.toggle('dark', toggle.checked);
blogList.style.backgroundColor= toggle.checked ? "rgba(0, 0, 0, 0.15)" : "rgba(255, 255, 255, 0.35)";
blogContent.style.backgroundColor= toggle.checked ? "rgba(0, 0, 0, 0.15)" : "rgba(255, 255, 255, 0.35)";
blogList.style.color= toggle.checked ? "rgba(255, 255, 255)" : "rgba(0, 0, 0)";
blogContent.style.color= toggle.checked ? "rgba(255, 255, 255)" : "rgba(0, 0, 0)";

});

</script>



<script>

window.addEventListener('DOMContentLoaded', () => {
  const countSpan = document.getElementById('count');

  // Step 1: Get visitor IP
  fetch('https://api.ipify.org?format=json')
    .then(res => res.json())
    .then(data => {
      const visitorIP = data.ip.replace(/\./g, '-'); // safe for URL key
      const localStorageKey = `visited-${visitorIP}`;
      const namespace = 'varad-blogs'; // CountAPI namespace
      const key = visitorIP; // each IP has its own key

      // Step 2: Check if already counted for this browser
      if (!localStorage.getItem(localStorageKey)) {
        // increment counter
        fetch(`https://api.countapi.xyz/hit/${namespace}/${key}`)
          .then(res => res.json())
          .then(data => {
            countSpan.textContent = data.value;
            localStorage.setItem(localStorageKey, 'true'); // mark as counted
          });
      } else {
        // just fetch the current value without incrementing
        fetch(`https://api.countapi.xyz/get/${namespace}/${key}`)
          .then(res => res.json())
          .then(data => countSpan.textContent = data.value);
      }
    })
    .catch(err => {
      console.error("Visitor counter failed:", err);
      countSpan.textContent = "N/A";
    });
});

</script>


</body>
</html>
